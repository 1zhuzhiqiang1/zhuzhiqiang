<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 6.0.8 (451398)"/><meta name="created" content="2015-11-10 10:39:34 +0000"/><meta name="source-url" content="file:///"/><meta name="updated" content="2015-11-10 10:39:34 +0000"/><title>面试技术03: 自定义View应用</title></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">
功能一: 快速索引列表
<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 目标技术:&nbsp;&nbsp; </div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;自定义View </div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;自定义监听器 </div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 功能描述: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><span style="font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">1. 好友列表功能:</span></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><span style="font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1). 对好友List集合按拼音首字母进行排序(需要用到pinyin4j.jar) &nbsp;&nbsp; </span></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><span style="font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2). 显示好友列表时, 显示拼音首字母 </span></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><span style="font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">2. 列表右侧A到Z列表功能:</span></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><span style="font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1). 从上至下均匀显示A到Z的所有字母 </span></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><span style="font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2). 在按下或移动到某个字母时, 字体大小和颜色都有变化 </span></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><span style="font-size: 14pt; color: rgb(1, 1, 1); font-family: Consolas;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3). 在按下或移动到某个字母时, 正中间区域会显示当前选择的字母, 且过一会自动消失 </span></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div align="left"><font color="#010101" face="Consolas" size="4"><span style="font-size: 14pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4). 在按下或移动到某个字母时, 列表会移动到对应的列表项区域</span></font></div></blockquote></blockquote><div><hr/></div><div>功能二: 滑动删除ListView的某项</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;目标技术:&nbsp;&nbsp; </div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;自定义ViewGroup(FrameLayout) </div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;功能描述: </div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 水平滑动列表的某一项可以打开或关闭 </div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;实现过程 </div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">1. 如何得到contentView和menuView对象?</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">1). 重写onAttachedToWindow()</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">2). 调用viewGroup.getChildAt(index)</blockquote></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">2. 如何得到contentView和menuView的宽高?</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">1). 重写onMeasure()</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">2). 调用getMeasuredWidth()和getMeasuredHeight()</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">3. 如何给contentView和menuView进行初始化布局定位?</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">1). 重写onLayout()</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">2). 调用layout()对contentView与menuView进行布局定位</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">4. 如何拖动contentView与menuView?</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">1). 重写onTouchEvent(), 计算移动时的偏移量</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">2). 通过scrollTo()来进行同步移动</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">5. 如何实现手指离开自动平滑打开/关闭</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">1). 在UP时, 根据当前偏移量判断是需要打开还是关闭</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">2). 使用Scroller对象的startScroll()实现平滑滚动</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">6. 如何解决手指滑动时ListView垂直方向滚动和SwipeView水平滑动的冲突问题?</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">1). 在move事件时, 获取x轴和y轴方向的移动距离distanceX, distanceY</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">2). 如果distanceX&gt;distanceY, 执行requestDisallowInterceptTouchEvent(true), 使ListView不能拦截event</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">7. 如何解决SwipeView滑动与ContentView/menuView点击事件的冲突问题?</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">1). 重写onInterceptTouchEvent()</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">2). 根据x轴方向的总偏移量是否大于5来决定是否拦截事件</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">8. 如何让ListView中同时只有一个SwipeView被打开?</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">1). 在SwipeView中, 定义监听接口,在接口中定义回调方法</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">2). 在SwipeView中, 定义设置监听接口对象的方法</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">3). 在SwipeView中, 在事件发生时, 调用监听对象处理</blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;">4). 在Activity的Adapter中, 为每个SwipeView对象设置监听器对象, 在回调方法中做处理</blockquote></blockquote><div><hr/></div><div>功能三: 自定义圆形真实进度条</div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;目标技术:&nbsp;&nbsp; </div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;自定义View </div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;图形绘制 </div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;自定义视图属性 </div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;功能描述: </div><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以圆形的方式显示真实进度变化 </div><div><hr/></div><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><b>自定义视图属性</b><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>1). 理解属性值的类型(format)</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1. reference 引用类型值</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2. color 颜色类型值</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3. boolean 布尔类型值</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4. dimension 尺寸类型值</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5. integer 整数类型值</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6. float 小数类型值</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 7. string 字符串类型值</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8. <enum> 枚举类型值</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>-----------------------------------------------------------------------------------------------------------------------</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>2). 定义属性: 在value目录下创建attrs.xml</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <!-- 定义名字为MyViewAttributes属性集合 --></div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <declare-styleable name="MyViewAttributes"></div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <!-- 定义类型为reference，属性名为my_name的属性 --></div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <attr name="my_name" format="string" /></div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <!-- 定义类型为integer，属性名为my_age的属性 --></div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <attr name="my_age" format="integer" /></div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <!-- 定义类型为reference，属性名为my_bg的属性 --></div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <attr name="my_bg" format="reference" /></div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </declare-styleable></div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>-----------------------------------------------------------------------------------------------------------------------</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>3). 在布局文件中引用当前应用的名称空间:</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 格式: xmlns:atguigu="http://schemas.android.com/apk/res/应用包名"</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 例子: xmlns:atguigu="http://schemas.android.com/apk/res/com.atguigu.myattr"</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>-----------------------------------------------------------------------------------------------------------------------</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>4). 在自定义视图标签中使用自定义属性:</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<com.atguigu.myattr.MyAttributeView </div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; atguigu:my_name="xfzhang" </div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; atguigu:my_age="30" </div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; atguigu:my_bg="@drawable/logo" </div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:layout_width="wrap_content" </div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; android:layout_height="wrap_content"/></div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>-----------------------------------------------------------------------------------------------------------------------</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>5). 在自定义View类的构造方法中, 取出布局中的属性值:</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //得到所有自定义属性的数组</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TypedArray typedArray = context.obtainStyledAttributes(attrs,R.styleable.MyViewAttributes);</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // 获取自定义属性的值, 如果没有指定取默认值</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; String name = typedArray.getString(R.styleable.MyViewAttributes_my_name, null);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int age = typedArray.getInt(R.styleable.MyViewAttributes_my_age, 10);</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int bg = typedArray.getResource(R.styleable.MyViewAttributes_my_bg, R.drawable.ic_launcher);</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //释放资源数据</div></blockquote><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; typedArray.recycle();</div></blockquote></blockquote><div><hr/></div><div>功能四: 侧滑菜单</div><div><br/></div><div><br/></div><div><br/><blockquote style="margin: 0 0 0 40px; border: none; padding: 0px;"><div align="left"><font color="#010101" face="Consolas" size="4"><span style="font-size:14pt"><br/></span></font></div></blockquote></div></body></html>